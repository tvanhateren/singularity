Bootstrap: docker
From: ubuntu:bionic

%help
	Factor version 1.3
	Provides:
		runfactor <parset>
		checkfactor <parset>
		archivefactor <parset> <output dir>
		unarchivefactor <archive dir> <output dir>

%environment
	export LC_ALL=C

%post
	export LC_ALL=C
	
	# Add key for kernsuite
	apt update
	apt install -y --no-install-recommends gnupg
	apt-key adv --keyserver keyserver.ubuntu.com --recv-keys B7D042E7

	# Set repository list
	cat << '	EOF' > /etc/apt/sources.list
		deb http://archive.ubuntu.com/ubuntu/ bionic main restricted universe multiverse 
		deb http://archive.ubuntu.com/ubuntu/ bionic-security main restricted universe multiverse 
		deb http://archive.ubuntu.com/ubuntu/ bionic-updates main restricted universe multiverse
		deb http://ppa.launchpad.net/kernsuite/kern-4/ubuntu bionic main 
	EOF

	# Install factor
	apt update
	apt install -y --no-install-recommends factor \
		python-casacore python-lofar \
		python-tk

	# Cleanup apt
	rm -rf /var/lib/apt/lists/*

%runscript
	exec bash "$@"
